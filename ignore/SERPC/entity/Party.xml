<?xml version="1.0" encoding="UTF-8"?>
<entities xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/entity-definition-3.xsd">
    
<!--    PARTY-->
    <entity entity-name="Party" package="SERPC" >
        <field name="partyId" type="id" is-pk="true"/>
        <field name="partyTypeEnumId" type="id"/>
        <field name="disabled" type="text-indicator" default="'N'"/>
        <field name="createdDate" type="date-time"/>

        <relationship type="one" title="PartyType" related="moqui.basic.Enumeration" short-alias="type">
            <key-map field-name="partyTypeEnumId"/></relationship>
        <relationship type="one" related="moqui.basic.DataSource"/>

        <relationship type="one-nofk" related="SERPC.Organization" short-alias="organization" mutable="true"/>
        <relationship type="one-nofk" related="SERPC.Person" short-alias="person" mutable="true"/>

        <relationship type="many" related="SERPC.PartyRole" short-alias="roles">
            <key-map field-name="partyId"/></relationship>

<!--        <relationship type="many" related="SERPC.contact.PartyContactMech" short-alias="contactMechs">-->
        <!--            <key-map field-name="partyId"/></relationship>-->

        <seed-data>
            <!-- Party Type -->
            <moqui.basic.EnumerationType description="Party Type" enumTypeId="PartyType"/>
            <moqui.basic.Enumeration description="Person" enumId="PtyPerson" enumTypeId="PartyType"/>
            <moqui.basic.Enumeration description="Organization" enumId="PtyOrganization" enumTypeId="PartyType"/>
        </seed-data>

        <master name="default">
            <detail relationship="type"/>
            <detail relationship="organization"/>
            <detail relationship="person"/>
            <detail relationship="contactMechs">
                <detail relationship="contactMech" use-master="default"/>
                <detail relationship="purpose"/>
            </detail>
        </master>
        <master name="contact">
            <detail relationship="type"/>
            <detail relationship="organization"/>
            <detail relationship="person"/>
            <detail relationship="identifications"><detail relationship="type"/></detail>
            <detail relationship="contactMechs">
                <detail relationship="contactMech" use-master="default"/>
                <detail relationship="purpose"/>
            </detail>
        </master>
        <master name="basic">
            <detail relationship="organization"/>
            <detail relationship="person"/>
            <detail relationship="identifications"><detail relationship="type"/></detail>
        </master>
    </entity>
    <entity entity-name="Organization" package="SERPC">
        <field name="partyId" type="id" is-pk="true"/>
        <field name="organizationName" type="text-medium"/>
        <field name="gstin" type="text-medium"/>
        <field name="address" type="text-medium"/>

        <relationship type="one" related="SERPC.Party"/>
        <index name="PTY_ORG_NAME_IDX"><index-field name="organizationName"/></index>
    </entity>

    <entity entity-name="Person" package="SERPC">
        <field name="partyId" type="id" is-pk="true"/>
        <field name="firstName" type="text-medium"/>
        <field name="middleName" type="text-medium"/>
        <field name="lastName" type="text-medium" enable-audit-log="update"/>
        <field name="gender" type="text-indicator"/>
        <field name="birthDate" type="date"/>
        <field name="deceasedDate" type="date"/>
        <field name="occupation" type="text-medium"/>

        <relationship type="one" related="SERPC.Party"/>
        <index name="FIRST_NAME_IDX"><index-field name="firstName"/></index>
        <index name="LAST_NAME_IDX"><index-field name="lastName"/></index>
    </entity>

    <entity entity-name="PartyRole" package="SERPC">
        <field name="partyId" type="id" is-pk="true"/>
        <field name="roleTypeId" type="id" is-pk="true"/>
        <relationship type="one" related="SERPC.Party" short-alias="party"/>
        <relationship type="one" related="SERPC.RoleType" short-alias="role"/>
    </entity>

    <entity entity-name="RoleType" package="SERPC" cache="true">
        <field name="roleTypeId" type="id" is-pk="true"/>
        <field name="description" type="text-medium"/>
        <relationship type="one" title="Parent" related="SERPC.RoleType"/>

        <seed-data>
            <SERPC.RoleType description="Administrator" roleTypeId="Administrator"/>

            <moqui.basic.Enumeration description="Person Roles" enumId="RgpPerson" enumTypeId="RoleGroup"/>
            <SERPC.RoleGroupMember roleGroupEnumId="RgpPerson" roleTypeId="Administrator"/>
            <SERPC.RoleGroupMember roleGroupEnumId="RgpPerson" roleTypeId="Agent"/>


            <moqui.basic.Enumeration description="Organization Roles" enumId="RgpOrganization" enumTypeId="RoleGroup"/>
            <SERPC.RoleGroupMember roleGroupEnumId="RgpOrganization" roleTypeId="OrgCorporation"/>

        </seed-data>
    </entity>
</entities>